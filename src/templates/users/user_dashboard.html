{% extends 'base.html' %}

{% load i18n %}


{% block title %}{% trans 'Dashboard' %}{% endblock title %}


{% block body %}

{% include '_includes/nav.html' %}

{% if not user.verified %}
<div class="container row">
  <div class="col-sm-offset-2 col-sm-8 alert alert-warning clearfix" role="alert">
    <p>{% trans 'You need to verify your email before being able to submit a proposal.' %}</p>
    <form method="post" action="{% url 'request_verification' %}" class="form form-inline">
      {% csrf_token %}
      <p>{% trans 'Did not get the verification email?' %}</p>
      <button type="submit" class="btn btn-link">{% trans 'Request a new one.' %}</button>
    </form>
  </div>
</div>
{% endif %}

<div class="row">
	<div class="col-md-offset-2 col-md-8">
		<div><a href="{% url 'user_profile_update' %}">{% trans 'Edit speaker profile' %}</a></div>

		{% if user.is_valid_speaker %}
		<div><a href="{% url 'proposal_create_choice' %}">{% trans 'Submit a Proposal' %}</a></div>
		{% endif %}

		{% if user.talkproposal_set.exists %}
		<div class="talk-proposals">
		  <h3>{% trans 'Talk Proposals' %}</h3>
        <table class="proposals-table table table-striped table-hover proposal">
            <thead>
              <tr>
                  <th>{% trans 'Title' %}</th>
                  <th>{% trans 'Abstract' %}</th>
                  <th>{% trans 'Python Level' %}</th>
                  <th>{% trans 'Language' %}</th>
                  <th></th>
              </tr>
            </thead>
            <tbody>
            {% for proposal in user.talkproposal_set.all %}
            <tr>
              <td>{{ proposal.title }}</td>
              <td>{{ proposal.abstract|truncatechars:30 }}</td>
              <td>{{ proposal.get_python_level_display }}</td>
              <td>{{ proposal.get_language_display }}</td>
              <td><a href="{% url 'talk_proposal_update' pk=proposal.pk %}"><button type="button" class="btn btn-default btn-primary">{% trans 'Edit' %}</button></a></td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
		</div>
		{% endif %}

    {% if user.tutorialproposal_set.exists %}
    <div class="tutorial-proposals">
      <h3>{% trans 'Tutorial Proposals' %}</h3>
      <table class="proposals-table table table-striped table-hover proposal">
            <thead>
              <tr>
                  <th>{% trans 'Title' %}</th>
                  <th>{% trans 'Abstract' %}</th>
                  <th>{% trans 'Python Level' %}</th>
                  <th>{% trans 'Language' %}</th>
                  <th></th>
              </tr>
            </thead>
            <tbody>
            {% for proposal in user.tutorialproposal_set.all %}
            <tr>
              <td>{{ proposal.title }}</td>
              <td>{{ proposal.abstract|truncatechars:30 }}</td>
              <td>{{ proposal.get_python_level_display }}</td>
              <td>{{ proposal.get_language_display }}</td>
              <td><a href="{% url 'tutorial_proposal_update' pk=proposal.pk %}">
                  <button type="button" class="btn btn-default btn-primary">{% trans 'Edit' %}</button>
              </a></td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
	</div>
</div>
{% endblock body %}


